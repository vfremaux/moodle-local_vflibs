{"version":3,"file":"orderedselect.min.js","sources":["../src/orderedselect.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n// jshint undef:false, unused:false, scripturl:true\n/* eslint no-undef: \"off\", no-unused-vars: \"off\" */\n\n/**\n * Javascript controller for orderedselect.\n *\n * @module     local_vflibs/orderedselect\n * @package    local_vflibs\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/log'], function($, log) {\n\n    var orderedselect = {\n\n        captured: null,\n\n        selectedoptions: [],\n\n        init: function(params) {\n\n            $('.orderedselect-delete').bind('click', this.removeselecteditem);\n            $('.orderedselect-select').bind('change', this.updatevalues);\n            $('.orderedselect-option').bind('mousedown', this.captureselecteditem);\n            $('.orderedselect-option').bind('mousedrag', this.drag);\n            $('.orderedselect-option').bind('mouseup', this.releaseselecteditem);\n\n            this.selectedoptions = params['options'];\n\n            log.debug(\"AMD orderedselect initialized\");\n        },\n\n        /**\n         * select a new option in the list. Will append to the end of the ordrered list.\n         * we assume the calling object is the option element.\n         */\n        toggleoption: function() {\n\n            var that = $(this);\n            var selectobj = that.nearest('select');\n            var valueid = '#' + selectobj.attr('id') + '-value';\n            var selectionid = '#' + selectobj.attr('id') + '-selection';\n\n            if (iselected) {\n                // Add selected div. ( create node)\n                $newnode = $(selectionid).appendNode();\n\n                // Add value to optionlist and register the html object.\n                // Refresh the hidden input with keys in order.\n                selectedoptions[that.attr('value')] = newnode;\n                $(valueid).html(orderedselect.selectedoptions.join(','));\n\n            } else {\n                // Remove value from option array and hidden input.\n                removedoptions = new Array();\n                for (opt in selectedoptions) {\n                    if (opt != that.attr('value')) {\n                        removedoptions[opt] = selectedoptions[opt];\n                    }\n                }\n                $(valueid).html(orderedselect.removedoptions.join(','));\n\n                // Delete selected div. (delete draggable selection node)\n                var optionid = selectobj.attr('id') + '-' + that.attr('value');\n                $(selectionid).deleteNode(optionid);\n            }\n        },\n\n        /**\n         * starts dragging\n         */\n        captureselecteditem: function(e) {\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            var that = $(this);\n\n            orderedselect.captured = that;\n            that.css('position', 'absolute');\n            that.css('opacity', 0.5);\n        },\n\n        /**\n         * move dragged item on screen while it is held\n         */\n        dragselecteditem: function(e) {\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            var that = $(this);\n\n            if (that.attr('id') === orderedselect.captured) {\n                if (orderedselect.captured !== '') {\n                    // reposition\n                    // Test if need to be swapped : if\n                }\n            }\n        },\n\n        /**\n         * updates the list and releases the held item.\n         */\n        releaseselecteditem: function(e) {\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            var that = $(this);\n\n            orderedselect.captured = null;\n            that.css('position', '');\n            that.css('opacity', 1);\n        },\n\n        /**\n         * clicked on the delete icon of the item.\n         */\n        removeselecteditem: function() {\n\n            var that = $(this);\n\n            var option = that.nearest('orderedselect-option');\n            // Delete node, remove value in hidden and unselect the related option in select.\n        }\n    };\n\n    return orderedselect;\n\n});"],"names":["define","$","log","orderedselect","captured","selectedoptions","init","params","bind","this","removeselecteditem","updatevalues","captureselecteditem","drag","releaseselecteditem","debug","toggleoption","that","selectobj","nearest","valueid","attr","selectionid","iselected","$newnode","appendNode","newnode","html","join","opt","removedoptions","Array","optionid","deleteNode","e","preventDefault","stopPropagation","css","dragselecteditem"],"mappings":";;;;;;;AAyBAA,OAAM,6BAAC,CAAC,SAAU,aAAa,SAASC,EAAGC,KAEvC,IAAIC,cAAgB,CAEhBC,SAAU,KAEVC,gBAAiB,GAEjBC,KAAM,SAASC,QAEXN,EAAE,yBAAyBO,KAAK,QAASC,KAAKC,oBAC9CT,EAAE,yBAAyBO,KAAK,SAAUC,KAAKE,cAC/CV,EAAE,yBAAyBO,KAAK,YAAaC,KAAKG,qBAClDX,EAAE,yBAAyBO,KAAK,YAAaC,KAAKI,MAClDZ,EAAE,yBAAyBO,KAAK,UAAWC,KAAKK,qBAEhDL,KAAKJ,gBAAkBE,OAAgB,QAEvCL,IAAIa,MAAM,gCACb,EAMDC,aAAc,WAEV,IAAIC,KAAOhB,EAAEQ,MACTS,UAAYD,KAAKE,QAAQ,UACzBC,QAAU,IAAMF,UAAUG,KAAK,MAAQ,SACvCC,YAAc,IAAMJ,UAAUG,KAAK,MAAQ,aAE/C,GAAIE,UAEAC,SAAWvB,EAAEqB,aAAaG,aAI1BpB,gBAAgBY,KAAKI,KAAK,UAAYK,QACtCzB,EAAEmB,SAASO,KAAKxB,cAAcE,gBAAgBuB,KAAK,UAEhD,CAGH,IAAKC,OADLC,eAAiB,IAAIC,MACT1B,gBACJwB,KAAOZ,KAAKI,KAAK,WACjBS,eAAeD,KAAOxB,gBAAgBwB,MAG9C5B,EAAEmB,SAASO,KAAKxB,cAAc2B,eAAeF,KAAK,MAGlD,IAAII,SAAWd,UAAUG,KAAK,MAAQ,IAAMJ,KAAKI,KAAK,SACtDpB,EAAEqB,aAAaW,WAAWD,SAC9B,CACH,EAKDpB,oBAAqB,SAASsB,GAE1BA,EAAEC,iBACFD,EAAEE,kBAEF,IAAInB,KAAOhB,EAAEQ,MAEbN,cAAcC,SAAWa,KACzBA,KAAKoB,IAAI,WAAY,YACrBpB,KAAKoB,IAAI,UAAW,GACvB,EAKDC,iBAAkB,SAASJ,GAEvBA,EAAEC,iBACFD,EAAEE,kBAESnC,EAAEQ,MAEJY,KAAK,QAAUlB,cAAcC,UAC9BD,cAAcC,QAKzB,EAKDU,oBAAqB,SAASoB,GAE1BA,EAAEC,iBACFD,EAAEE,kBAEF,IAAInB,KAAOhB,EAAEQ,MAEbN,cAAcC,SAAW,KACzBa,KAAKoB,IAAI,WAAY,IACrBpB,KAAKoB,IAAI,UAAW,EACvB,EAKD3B,mBAAoB,WAELT,EAAEQ,MAEKU,QAAQ,uBAE9B,GAGJ,OAAOhB,aAEX"}